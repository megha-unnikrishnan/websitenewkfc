(this["webpackJsonpreusable-comps"]=this["webpackJsonpreusable-comps"]||[]).push([[34],{434:function(e,n,t){"use strict";t.r(n);var l,a,i=t(28),o=t(4),d=t.n(o),c=t(37),r=t(10),u=t(1005),v=t(11),s=t(7),E=t(49),O=t(69),b=t(224),A=t(33),P=t(1173),m=t.n(P),p=t(356),C=t(849),_=t(13),y=t(16),j=t(3),T=t(68),f={SELECT_YOUR_PAYMENT:"SELECT YOUR PAYMENT",BRAINTREE_PAYMENT_TYPE:{KEY_CARD:"card",KEY_CREDIT_CARD:"CreditCard",KEY_PAY_PAL:"paypal",KEY_PAY_PAL_ACCOUNT:"PayPalAccount",KEY_PAY_PAL_CREDIT:"paypalCredit",KEY_GOOGLE_PAY:"googlePay",KEY_ANDROID_PAY_CARD:"AndroidPayCard",KEY_APPLE_PAY:"applePay",KEY_APPLE_PAY_CARD:"ApplePayCard",KEY_VENMO_ACCOUNT:"VenmoAccount"},BRAINTREE_EVENT:{CHANGE_ACTIVE_VIEW:"changeActiveView",PAYMENT_METHOD_REQUESTABLE:"paymentMethodRequestable",NO_PAYMENT_METHOD_REQUESTABLE:"noPaymentMethodRequestable",PAYMENT_OPTION_SELECTED:"paymentOptionSelected"},BRAINTREE_CHECKOUT:"checkout",BRAINTREE_VAULT:"vault",BRAINTREE_FINAL:"final"},h=f.BRAINTREE_PAYMENT_TYPE,N=f.BRAINTREE_EVENT,R=(l={},Object(A.a)(l,h.KEY_CARD,j.Cc.CREDIT_CARD),Object(A.a)(l,h.KEY_PAY_PAL,j.Cc.PAY_PAL),Object(A.a)(l,h.KEY_GOOGLE_PAY,j.Cc.GOOGLE_PAY),Object(A.a)(l,h.KEY_APPLE_PAY,j.Cc.APPLE_PAY),Object(A.a)(l,h.KEY_APPLE_PAY,j.Cc.VENMO),Object(A.a)(l,h.KEY_CREDIT_CARD,j.Cc.CREDIT_CARD),Object(A.a)(l,h.KEY_PAY_PAL_ACCOUNT,j.Cc.PAY_PAL),Object(A.a)(l,h.KEY_ANDROID_PAY_CARD,j.Cc.GOOGLE_PAY),Object(A.a)(l,h.KEY_APPLE_PAY_CARD,j.Cc.APPLE_PAY),Object(A.a)(l,h.KEY_VENMO_ACCOUNT,j.Cc.VENMO),l),I=(a={},Object(A.a)(a,j.Cc.CREDIT_CARD,h.KEY_CARD),Object(A.a)(a,j.Cc.PAY_PAL,h.KEY_PAY_PAL),Object(A.a)(a,j.Cc.GOOGLE_PAY,h.KEY_GOOGLE_PAY),Object(A.a)(a,j.Cc.APPLE_PAY,h.KEY_APPLE_PAY),Object(A.a)(a,j.Cc.VENMO,h.KEY_APPLE_PAY),a),Y=function(e){var n,t;return(null===e||void 0===e?void 0:e.isPaymentTypeSelected)&&Object(s.gd)(null===e||void 0===e||null===(n=e.tender)||void 0===n?void 0:n.name)&&Object(s.Qc)(null===e||void 0===e||null===(t=e.tender)||void 0===t?void 0:t.payload)},D=function(e){return null===e||void 0===e?void 0:e.map((function(e){return I[e]}))},M=function(e,n,t){return n&&(null===e||void 0===e?void 0:e.isPaymentTypeSelected)!==t&&n({isPaymentTypeSelected:t})},k=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e&&e({isPaymentTypeSelected:!0,tender:{name:R[n],payload:t}})},L=function(e){return e({isPaymentTypeSelected:!1,tender:{name:"",payload:{}}})},B=function(e,n){var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e&&(null===e||void 0===e||e.requestPaymentMethod((function(l,a){if(l)return t&&n({showPaymentPreValidationError:!0}),void L(n);a?(n({showPaymentPreValidationError:!1}),k(n,null===a||void 0===a?void 0:a.type,a)):(n({showPaymentPreValidationError:!0}),null===e||void 0===e||e.clearSelectedPaymentMethod())})))},g=function(e){var n=e.allowedTenders,t=e.userParams;return!(null===n||void 0===n||!n.includes(j.Cc.CREDIT_CARD))&&{vault:{allowVaultCardOverride:!1,vaultCard:null===t||void 0===t?void 0:t.loggedIn}}},S=function(e){var n=e.finalAmount,t=e.countryCode,l=e.currencyCode,a=e.allowedTenders;return!(null===a||void 0===a||!a.includes(j.Cc.GOOGLE_PAY))&&{merchantId:Object(y.a)(_.l),transactionInfo:{currencyCode:l,countryCode:t,totalPriceStatus:Object(s.Pd)(f.BRAINTREE_FINAL),totalPrice:n}}},x=function(e){var n=e.finalAmount,t=e.currencyCode,l=e.allowedTenders,a=e.userParams;return!(null===l||void 0===l||!l.includes(j.Cc.PAY_PAL))&&{flow:null!==a&&void 0!==a&&a.loggedIn?null===f||void 0===f?void 0:f.BRAINTREE_VAULT:null===f||void 0===f?void 0:f.BRAINTREE_CHECKOUT,amount:n,currency:t,commit:!1,vault:{vaultPayPal:null===a||void 0===a?void 0:a.loggedIn}}},V=function(e){var n=e.finalAmount,t=e.currencyCode,l=e.allowedTenders,a=e.userParams;return!(null===l||void 0===l||!l.includes(j.Cc.PAY_PAL_CREDIT))&&{flow:null!==a&&void 0!==a&&a.loggedIn?null===f||void 0===f?void 0:f.BRAINTREE_VAULT:null===f||void 0===f?void 0:f.BRAINTREE_CHECKOUT,amount:n,currency:t,commit:!1,vault:{vaultPayPal:null===a||void 0===a?void 0:a.loggedIn}}},H=function(e){var n=e.service,t=e.finalAmount,l=e.allowedTenders;return!(null===l||void 0===l||!l.includes(j.Cc.APPLE_PAY))&&{displayName:Object(y.a)(_.m),paymentRequest:{total:{label:n,amount:t}}}},w=function(e){return!(null===e||void 0===e||!e.includes(j.Cc.VENMO))&&{allowNewBrowserTab:!1}},U=function(e){var n=e.dispatch,t=e.braintreeInstance,l=e.setBraintreeInstance,a=e.checkoutDetails,i=e.updateCheckoutDetails,o=e.braintreePaymentReducer;if(null!==a&&void 0!==a&&a.isClickAddPayment&&null!==o&&void 0!==o&&o.token){n(Object(C.b)());var d;if(t)null===t||void 0===t||null===(d=t.teardown())||void 0===d||d.then((function(){l(void 0)}));else t||m.a.create(function(e,n){var t=e.currencyFormat,l=e.allowedTenders;return{authorization:null===n||void 0===n?void 0:n.token,container:"#braintree-drop-in-div",locale:t,paymentOptionPriority:D(l),card:g(e),paypal:x(e),paypalCredit:V(e),googlePay:S(e),applePay:H(e),venmo:w(l),dataCollector:!0,threeDSecure:!1,vaultManager:!0,preselectVaultedPaymentMethod:!0,showDefaultPaymentMethodFirst:!0}}(a,o),(function(e,t){n(Object(C.a)()),e?(console.debug("Error - dropin Create ****====> ",e),M(a,i,!1)):l(t)}))}},K=function(e,n){null===e||void 0===e||!e.paymentEnabled||null!==e&&void 0!==e&&e.isClickAddPayment?Object(u.B)(e,n):(n({isClickAddPayment:!0,tender:{name:"",payload:{}},isClickContinuePayment:!1,isPaymentTypeSelected:!1,showPreValidationPaymentContactError:!1}),Object(T.c)({popupTitle:null===f||void 0===f?void 0:f.SELECT_YOUR_PAYMENT}))},G=t(5),q=function(e,n){var t,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3?arguments[3]:void 0;return""===(null===e||void 0===e||null===(t=e.tender)||void 0===t?void 0:t.name)&&Object(G.jsx)("div",{className:"addPaymentContent d-flex flex-column mt-20px ".concat(l),children:Object(G.jsx)(E.c,{variant:E.b.primary,inactive:!a,fullWidth:!0,"data-testid":"pay-button",onClick:function(){return K(e,n)},children:Object(r.e)(null===v.a||void 0===v.a?void 0:v.a.ADD_PAYMENT_METHOD_HEADER)})})},F=function(e){var n=function(){var n,t;return 0===(null===e||void 0===e||null===(n=e.allowedTenders)||void 0===n?void 0:n.length)?null===v.a||void 0===v.a?void 0:v.a.NO_PAYMENT_OPTION_AVAILABLE:null!==e&&void 0!==e&&null!==(t=e.userParams)&&void 0!==t&&t.loggedIn&&!Object(u.h)(e)?null===v.a||void 0===v.a?void 0:v.a.INVALID_CUSTOMER_INFO_ERROR:null};return n()&&Object(G.jsxs)("div",{className:"row row-cols-12 mt-10px payment-failed-error-box",children:[Object(G.jsx)(O.a,{srcFile:b.a.Error,className:"mt-3px mr-5px"}),Object(G.jsx)("div",{className:"ml-10px",children:Object(r.e)(n())})]})},Q=function(e){var n=e.dispatch,t=e.orderReducer,l=e.checkoutDetails,a=e.updateCheckoutDetails,i=e.onClickCallBackHandler,o=void 0===i?null:i,d=e.label,c=void 0===d?null:d,s=e.disabled,O=void 0===s?null:s,b=e.loading,A=void 0!==b&&b;return Object(G.jsx)("div",{className:"checkoutAmountDetails",children:Object(G.jsx)(E.c,{id:Object(r.e)(v.a.CONTINUE_PAYMENT),variant:E.b.primary,inactive:O,loading:A,fullWidth:!0,onClick:function(){return o?o(n,t,l,a):Object(u.c)(n,t,l,a)},"data-testid":"continue-to-payment-btn",children:c||W(l)})})},W=function(e){return Object(G.jsxs)("span",{children:[Object(r.e)(v.a.CONTINUE_PAYMENT),Object(G.jsxs)("span",{className:"rupee-text",children:[" ",null===e||void 0===e?void 0:e.currencySymbol,null===e||void 0===e?void 0:e.finalAmount," "]})]})},z=function(e){return Object(G.jsx)("div",{className:"mt-25px info-note txt-align-center",children:Object(G.jsxs)("span",{children:[Object(r.e)(null===v.a||void 0===v.a?void 0:v.a.CLICK_PLACE_ORDER_CONFIRM_AGREE)," ",Object(G.jsx)("span",{className:"link","data-testid":"terms-condition",onClick:function(){return Object(s.Md)(e)},children:Object(r.e)(null===v.a||void 0===v.a?void 0:v.a.TERMS_OF_USE)})," ",Object(r.e)(null===v.a||void 0===v.a?void 0:v.a.AND)," ",Object(G.jsx)("span",{className:"link","data-testid":"privacy-policy",onClick:function(){return Object(s.Kd)(e)},children:Object(r.e)(null===v.a||void 0===v.a?void 0:v.a.PRIVACY)})]})})},J=function(e){var n,t,l,a,E=Object(c.b)(),O=Object(o.useState)(void 0),b=Object(i.a)(O,2),A=b[0],P=b[1],m=Object(c.c)((function(e){return e})),C=m.orderReducer,_=m.braintreePaymentReducer,y=m.cartReducer,j=m.tenantReducer,T=Object(c.c)((function(e){var n;return null===(n=e.braintreePaymentReducer)||void 0===n?void 0:n.isGenerateClientTokenLoading})),f=Object(c.c)((function(e){var n,t;return(null===(n=e.orderReducer)||void 0===n?void 0:n.isPlaceOrder)||(null===(t=e.braintreePaymentReducer)||void 0===t?void 0:t.transactionSaleLoading)})),h=e.checkoutDetails,I=e.updateCheckoutDetails,D=h.userParams,k=h.isPaymentTypeSelected,g=h.tender,S=h.isCateringSomeOneElseContactDetailsAreValid,x=Object(o.useRef)(h),V=j.currencyConversionFactor,H=y.cartData,w=void 0===H?{}:H,K=Object(s.pb)(w)||{},W=K.couponCode,J=void 0===W?"":W,X=K.amount,Z=void 0===X?"":X,$=Object(s.zc)(D),ee=$.localized,ne=void 0!==ee&&ee,te=$.loggedIn,le=void 0!==te&&te,ae=Object(s.vc)(ne,le);d.a.useEffect((function(){x.current=h}),[k,null===g||void 0===g?void 0:g.name,null===g||void 0===g?void 0:g.payload]);var ie,oe=Object(o.useCallback)((function(e){return function(e,n,t){"delete-confirmation"===(null===t||void 0===t?void 0:t.newViewId)&&M(e,n,!1),"options"===(null===t||void 0===t?void 0:t.newViewId)&&"delete-confirmation"===(null===t||void 0===t?void 0:t.previousViewId)&&L(n)}(x.current,I,e)}),[x.current,I]),de=Object(o.useCallback)((function(e){return function(e,n,t,l){var a,i,o;l&&null!==Object&&void 0!==Object&&null!==(a=Object.prototype)&&void 0!==a&&null!==(i=a.hasOwnProperty)&&void 0!==i&&null!==(o=i.call)&&void 0!==o&&o.call(i,l,"paymentMethodIsSelected")&&(null!==l&&void 0!==l&&l.paymentMethodIsSelected&&R[null===l||void 0===l?void 0:l.type]?B(t,n):M(e,n,!0))}(x.current,I,A,e)}),[x.current,I,A]),ce=Object(o.useCallback)((function(e){return function(e,n,t){L(n)}(x.current,I)}),[x.current,I]),re=Object(o.useCallback)((function(e){return console.log("paymentOptionSelected *****> ",e)}),[]);return Object(o.useEffect)((function(){return A&&function(e){if(null!==e&&void 0!==e&&e.braintreeInstance){var n=e.braintreeInstance,t=e.changeActiveViewHandlerBind,l=e.paymentMethodRequestableHandlerBind,a=e.noPaymentMethodRequestableHandlerBind,i=e.paymentOptionSelectedHandlerBind;null===n||void 0===n||n.off(N.CHANGE_ACTIVE_VIEW,t),null===n||void 0===n||n.off(N.PAYMENT_METHOD_REQUESTABLE,l),null===n||void 0===n||n.off(N.NO_PAYMENT_METHOD_REQUESTABLE,a),null===n||void 0===n||n.off(N.PAYMENT_OPTION_SELECTED,i)}}({braintreeInstance:A,changeActiveViewHandlerBind:oe,paymentMethodRequestableHandlerBind:de,noPaymentMethodRequestableHandlerBind:ce,paymentOptionSelectedHandlerBind:re})}),[]),Object(o.useEffect)((function(){var e;null!==D&&void 0!==D&&D.loggedIn&&""!==(null===h||void 0===h||null===(e=h.userFullName)||void 0===e?void 0:e.value)&&I({paymentEnabled:!0,isClickAddPayment:!0})}),[null===h||void 0===h||null===(n=h.userFullName)||void 0===n?void 0:n.value]),Object(o.useEffect)((function(){null!==h&&void 0!==h&&h.isClickAddPayment&&(L(I),function(e){var n=e.props,t=e.dispatch,l=e.checkoutDetails,a=e.updateCheckoutDetails,i=l.tenantId,o=l.customerId,d=l.userFirstName,c=l.userLastName,r=l.userPhone,u=l.userEmail;l.isClickAddPayment&&t(Object(p.a)({tenantId:i,customerId:o,data:{id:o,firstName:null===d||void 0===d?void 0:d.value,lastName:(null===c||void 0===c?void 0:c.value)||(null===d||void 0===d?void 0:d.value),phone:null===r||void 0===r?void 0:r.value,email:null===u||void 0===u?void 0:u.value}},(function(e){e&&(null===e||void 0===e?void 0:e.status)>=400&&a({showPaymentError:!0})}),(function(e){Object(s.Id)(n),console.log("error ===> ",e)})))}({props:e,dispatch:E,checkoutDetails:h,updateCheckoutDetails:I}))}),[null===h||void 0===h?void 0:h.isClickAddPayment]),Object(o.useEffect)((function(){U({dispatch:E,braintreeInstance:A,setBraintreeInstance:P,checkoutDetails:h,updateCheckoutDetails:I,braintreePaymentReducer:_})}),[null===_||void 0===_?void 0:_.token]),Object(o.useEffect)((function(){A?(!function(e){if(null!==e&&void 0!==e&&e.braintreeInstance){var n=e.braintreeInstance,t=e.changeActiveViewHandlerBind,l=e.paymentMethodRequestableHandlerBind,a=e.noPaymentMethodRequestableHandlerBind,i=e.paymentOptionSelectedHandlerBind,o=function(e){var t,l,a;return void 0===(null===n||void 0===n||null===(t=n._events)||void 0===t?void 0:t[e])||0===(null===n||void 0===n||null===(l=n._events)||void 0===l||null===(a=l[e])||void 0===a?void 0:a.length)};o(N.CHANGE_ACTIVE_VIEW)&&(null===n||void 0===n||n.on(N.CHANGE_ACTIVE_VIEW,t)),o(N.PAYMENT_METHOD_REQUESTABLE)&&(null===n||void 0===n||n.on(N.PAYMENT_METHOD_REQUESTABLE,l)),o(N.NO_PAYMENT_METHOD_REQUESTABLE)&&(null===n||void 0===n||n.on(N.NO_PAYMENT_METHOD_REQUESTABLE,a)),o(N.PAYMENT_OPTION_SELECTED)&&(null===n||void 0===n||n.on(N.PAYMENT_OPTION_SELECTED,i))}}({braintreeInstance:A,checkoutDetails:h,updateCheckoutDetails:I,changeActiveViewHandlerBind:oe,paymentMethodRequestableHandlerBind:de,noPaymentMethodRequestableHandlerBind:ce,paymentOptionSelectedHandlerBind:re}),B(A,I,!1)):!A&&null!==h&&void 0!==h&&h.isClickAddPayment&&null!==_&&void 0!==_&&_.token&&U({dispatch:E,braintreeInstance:A,setBraintreeInstance:P,checkoutDetails:h,updateCheckoutDetails:I,braintreePaymentReducer:_,changeActiveViewHandlerBind:oe,paymentMethodRequestableHandlerBind:de,noPaymentMethodRequestableHandlerBind:ce,paymentOptionSelectedHandlerBind:re})}),[A]),Object(o.useEffect)((function(){!function(e){var n,t,l,a,i,o,d=e.props,c=e.dispatch,r=e.orderReducer,u=e.checkoutDetails,v=u.tenantId,E=u.customerId,O=u.tender;null!==r&&void 0!==r&&null!==(n=r.response)&&void 0!==n&&null!==(t=n.order)&&void 0!==t&&t.id&&null!==O&&void 0!==O&&O.name&&c(Object(p.c)({tenantId:v,customerId:E,postBody:{orderId:null===r||void 0===r||null===(l=r.response)||void 0===l||null===(a=l.order)||void 0===a?void 0:a.id,paymentMethodNonce:null===O||void 0===O||null===(i=O.payload)||void 0===i?void 0:i.nonce,deviceData:null===O||void 0===O||null===(o=O.payload)||void 0===o?void 0:o.deviceData,tenderType:null===O||void 0===O?void 0:O.name}},(function(e){e&&(null===e||void 0===e?void 0:e.status)>=400||null!==e&&void 0!==e&&e.errorDescription?Object(s.Id)(d):Object(s.Gd)(d)}),(function(e){console.debug("transactionSale error ****=====> ",e),Object(s.Id)(d)})))}({props:e,dispatch:E,orderReducer:C,checkoutDetails:h,updateCheckoutDetails:I})}),[null===C||void 0===C||null===(t=C.response)||void 0===t||null===(l=t.order)||void 0===l?void 0:l.id,null===h||void 0===h?void 0:h.isCreateOrderValidateCompleted]),Object(o.useEffect)((function(){var e={cartData:w,currencyConversionFactor:V,categoryMapByUrl:null===h||void 0===h?void 0:h.categoryMapByUrl,userType:ae,amount:Z,couponCode:J};!function(e,n,t){null!==e&&void 0!==e&&e.isUpdateCheckoutContactAnalytics||null===e||void 0===e||!e.paymentEnabled||null===e||void 0===e||!e.isPaymentTypeSelected||(Object(u.a)(t.cartData,t.currencyConversionFactor,t.categoryMapByUrl,t.userType,t.amount,t.couponCode),n({isUpdateCheckoutContactAnalytics:!0}))}(h,I,e)}),[null===h||void 0===h?void 0:h.paymentEnabled]),Object(o.useEffect)((function(){var e;if(null!==h&&void 0!==h&&null!==(e=h.tender)&&void 0!==e&&e.name){var n,t=null===h||void 0===h||null===(n=h.tender)||void 0===n?void 0:n.name;Object(u.i)(w,V,null===h||void 0===h?void 0:h.categoryMapByUrl,t,ae,Z,J)}}),[null===h||void 0===h||null===(a=h.tender)||void 0===a?void 0:a.name]),Object(G.jsxs)("div",{className:"row row-cols-12 mt-10px",children:[(ie=Object(r.e)(null===v.a||void 0===v.a?void 0:v.a.PAYMENT_OPTIONS),Object(G.jsx)("div",{className:"labelContent contact-label pl-25px col-sm-4 col-12",children:Object(G.jsx)("span",{children:ie})})),Object(G.jsxs)("div",{className:"payment-au px-25px col-sm-8 col-12 mb-40px",children:[F(h),!(null!==h&&void 0!==h&&h.isClickAddPayment)&&q(h,I,"mb-30px checkoutAmountDetails",null===h||void 0===h?void 0:h.paymentEnabled),(null===h||void 0===h?void 0:h.isClickAddPayment)&&Object(G.jsx)("div",{className:"braintreePaymentContent",children:Object(G.jsx)("div",{id:"braintree-drop-in-div"})}),T&&Object(G.jsx)("div",{className:"placeholder",children:Object(G.jsxs)("div",{className:"table",children:[Object(G.jsx)("div",{className:"loading table-content"}),Object(G.jsx)("div",{className:"loading table-content"}),Object(G.jsx)("div",{className:"loading table-content"})]})}),(null===h||void 0===h?void 0:h.isClickAddPayment)&&Q({dispatch:E,orderReducer:C,checkoutDetails:h,updateCheckoutDetails:I,onClickCallBackHandler:function(){return function(e){var n=e.dispatch,t=e.orderReducer,l=e.braintreeInstance,a=e.checkoutDetails,i=e.updateCheckoutDetails;Y(a)?Object(u.c)(n,t,a,i):B(l,i)}({dispatch:E,orderReducer:C,braintreeInstance:A,checkoutDetails:h,updateCheckoutDetails:I})},label:Object(s.mc)(Y(h),Object(r.e)(null===v.a||void 0===v.a?void 0:v.a.PLACE_ORDER),Object(r.e)(null===v.a||void 0===v.a?void 0:v.a.CONTINUE)),disabled:Object(s.db)(!k,f,!S),loading:f}),(null===h||void 0===h?void 0:h.isClickAddPayment)&&Y(h)&&z(e)]})]})};n.default=d.a.memo(J)}}]);