(this["webpackJsonpreusable-comps"]=this["webpackJsonpreusable-comps"]||[]).push([[90],{737:function(e,n,t){"use strict";t.r(n);var o=t(0),r=t(28),i=t(4),d=t(37),u=t(44),l=t(10),c=t(807),v={ORDERS_NOW:"ordersNow",TRACK_ORDER:"trackOrder",WE_ARE_WORKING_ON:"weAreWorkingOn",YOUR_ORDER:"yourOrder",HAS_BEEN_CONFIRMED:"hasBeenConfirmed",HAS_SCHEDULED:"hasScheduled",PICKUP:"takeaway",AT:"At",DELIVERY:"delivery"},a=t(3),s=t(7),E=t(925),O=t(134),f=t(5);n.default=function(e){var n=Object(d.b)(),t={history:Object(u.g)()},I=Object(d.c)((function(e){return e})),b=I.tenantReducer,R=I.orderHistoryReducer,_=I.profileReducer,D=I.appStateReducer,T=(D=void 0===D?{}:D).userStatus,A=(T=void 0===T?{}:T).loggedIn,S=Object(i.useState)(!1),p=Object(r.a)(S,2),C=p[0],j=p[1],y=Object(i.useState)(""),g=Object(r.a)(y,2),P=g[0],m=g[1],N=Object(i.useState)(),h=Object(r.a)(N,2),L=h[0],Y=h[1],k=function(){L&&(clearTimeout(L),Y(void 0))};Object(i.useEffect)((function(){return k(),n(Object(c.e)()),function(){return k()}}),[]);var H=function(){if(A&&null!==_&&void 0!==_&&_.customerId&&null!==b&&void 0!==b&&b.tenantId&&null!==e&&void 0!==e&&e.isHeaderTrackOrderEnabled()){n(Object(c.c)({customerId:null===_||void 0===_?void 0:_.customerId,tenantId:null===b||void 0===b?void 0:b.tenantId},{OrderStatus:"",OrderMode:""}))}};Object(i.useEffect)((function(){k(),H()}),[null===_||void 0===_?void 0:_.customerId,null===b||void 0===b?void 0:b.tenantId]);Object(i.useEffect)((function(){var n,t,o,r;!R||null===R||void 0===R||!R.activeOrderHistory||null!==R&&void 0!==R&&R.activeOrderHistoryLoading||(null!==R&&void 0!==R&&null!==(n=R.activeOrderHistory)&&void 0!==n&&n.length?(!1===(null===b||void 0===b||null===(t=b.componentOptions)||void 0===t||null===(o=t.web)||void 0===o||null===(r=o.global)||void 0===r?void 0:r.showBlackStripWithOrderTracker)&&e.setShowBlackStripeContent(!1),!C&&j(!0),m(V()),!L&&Y(setTimeout((function(){k(),H()}),18e4))):C&&j(!1))}),[null===R||void 0===R?void 0:R.activeOrderHistory]);var V=function(){var e,n;if(1!==(null===R||void 0===R||null===(e=R.activeOrderHistory)||void 0===e?void 0:e.length))return"".concat(Object(l.e)(v.WE_ARE_WORKING_ON)," ").concat(null===R||void 0===R||null===(n=R.activeOrderHistory)||void 0===n?void 0:n.length," ").concat(Object(l.e)(v.ORDERS_NOW));var t,o,r=null===R||void 0===R?void 0:R.activeOrderHistory[0];if(!1===(null===r||void 0===r||null===(t=r.requestedDateTime)||void 0===t?void 0:t.isForNow)){var i="".concat(Object(l.e)(v.YOUR_ORDER)," # ").concat(null===r||void 0===r?void 0:r.posOrderId," ").concat(Object(l.e)(v.HAS_SCHEDULED)," ");return Object(s.Pd)(null===r||void 0===r?void 0:r.service)===a.bb.DELIVERY?"".concat(i," ").concat(Object(l.e)(v.DELIVERY)," ").concat(Object(l.e)(v.AT)):Object(s.Pd)(null===r||void 0===r?void 0:r.service)===a.bb.PICKUP?"".concat(i," ").concat(Object(l.e)(v.PICKUP)," ").concat(Object(l.e)(v.AT)):"".concat(i)}return Object(s.Pd)(null===r||void 0===r?void 0:r.service)===a.bb.DELIVERY?"".concat(Object(l.e)(v.YOUR_ORDER)," # ").concat(null===r||void 0===r?void 0:r.posOrderId," ").concat(Object(l.e)(v.HAS_BEEN_CONFIRMED)):Object(s.Pd)(null===r||void 0===r?void 0:r.service)===a.bb.PICKUP?"".concat(Object(l.e)(v.WE_ARE_WORKING_ON)," ").concat(null===R||void 0===R||null===(o=R.activeOrderHistory)||void 0===o?void 0:o.length," ").concat(Object(l.e)(v.ORDERS_NOW)):void 0},U=Object(i.useCallback)((function(){var e,n;(null===R||void 0===R||null===(e=R.activeOrderHistory)||void 0===e?void 0:e.length)>1?Object(s.ud)(t):1===(null===R||void 0===R||null===(n=R.activeOrderHistory)||void 0===n?void 0:n.length)&&function(e){if(null!==e&&void 0!==e&&e.id){var n=Object(o.a)(Object(o.a)({},e),{},{customer:null===_||void 0===_?void 0:_.basic}),r=Object(E.w)(null===b||void 0===b?void 0:b.tenantId,n);r.postOrderDetails={},sessionStorage.setItem(a.ac.ORDER_TRACKING,JSON.stringify(r)),Object(s.jc)()===a.H.IN?Object(s.Jd)(t):Object(s.Gd)(t)}else console.error(JSON.stringify(e)),Object(s.Id)(t)}(null===R||void 0===R?void 0:R.activeOrderHistory[0])}),[R]);return C&&Object(f.jsx)(O.a,Object(o.a)(Object(o.a)({},e),{},{testId:"HeaderTrackOrderItems",importPath:"APP_HEADER_ORDER_TRACKER_VIEW",buttonText:Object(l.e)(v.TRACK_ORDER),trackOrderTitle:P,onTrackOrderBtnClickHandler:U}))}},760:function(e,n,t){"use strict";t.d(n,"c",(function(){return r})),t.d(n,"d",(function(){return i})),t.d(n,"a",(function(){return d})),t.d(n,"b",(function(){return u}));var o=t(1);function r(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:o.POST_ORDER_ACCEPTED,payload:e,successCallback:n,errorCallback:t}}function i(){return{type:o.RESET_POST_ORDER}}function d(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:o.CANCEL_POST_ORDER,payload:e,successCallback:n,errorCallback:t}}function u(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:o.CHECK_IN_REQUEST,payload:e,successCallback:n,errorCallback:t}}},807:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"f",(function(){return i})),t.d(n,"b",(function(){return d})),t.d(n,"d",(function(){return u})),t.d(n,"c",(function(){return l})),t.d(n,"e",(function(){return c}));var o=t(1);function r(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:o.SET_FAVOURITE_ORDER,payload:e,postBody:n,successCallback:t,errorCallback:r}}function i(){return{type:o.RESET_ORDER_HISTORY}}function d(e){var n=e.tenantId,t=e.customerId,r=e.itemId,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:o.DELETE_FAVOURITE_ORDER,payload:{tenantId:n,customerId:t,itemId:r},successCallback:i,errorCallback:d}}function u(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:o.GET_ORDER_HISTORY,payload:e,postBody:n,successCallback:t,errorCallback:r}}function l(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:o.GET_ACTIVE_ORDER_HISTORY,payload:e,postBody:n,successCallback:t,errorCallback:r}}function c(){return{type:o.RESET_ACTIVE_ORDER_HISTORY}}},815:function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"e",(function(){return i})),t.d(n,"g",(function(){return d})),t.d(n,"f",(function(){return u})),t.d(n,"d",(function(){return l})),t.d(n,"a",(function(){return c})),t.d(n,"c",(function(){return v}));var o=t(1);function r(e){return{type:o.GET_NETBANKING_CONFIGURATIONS,payload:e}}function i(e){return{type:o.PAYMENT_USING_NETBANKING,payload:e}}function d(){return{type:o.RESET_PAYMENT_STATUS}}function u(e){return{type:o.PAYMENT_USING_PHONEPE,payload:e}}function l(e){return{type:o.GET_PAYTM_TOKEN_CALL,payload:e}}function c(e){return{type:o.PAYTM_STATUS_CHECK,payload:e}}function v(e){return{type:o.FETCH_OTHER_WALLETS_LIST,payload:e}}},843:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"c",(function(){return r})),t.d(n,"b",(function(){return i})),t.d(n,"d",(function(){return d}));var o=20,r=5e3,i=15e3,d=18e4},925:function(e,n,t){"use strict";t.d(n,"p",(function(){return s})),t.d(n,"o",(function(){return E})),t.d(n,"l",(function(){return O})),t.d(n,"f",(function(){return f})),t.d(n,"m",(function(){return I})),t.d(n,"n",(function(){return b})),t.d(n,"h",(function(){return R})),t.d(n,"j",(function(){return _})),t.d(n,"i",(function(){return D})),t.d(n,"g",(function(){return T})),t.d(n,"k",(function(){return A})),t.d(n,"r",(function(){return p})),t.d(n,"a",(function(){return C})),t.d(n,"b",(function(){return y})),t.d(n,"d",(function(){return g})),t.d(n,"c",(function(){return Y})),t.d(n,"s",(function(){return k})),t.d(n,"v",(function(){return H})),t.d(n,"q",(function(){return V})),t.d(n,"u",(function(){return U})),t.d(n,"w",(function(){return G})),t.d(n,"e",(function(){return F})),t.d(n,"t",(function(){return W}));var o=t(0),r=t(760),i=t(233),d=t(31),u=t(7),l=t(843),c=t(3),v=t(38),a=t(815),s=function(e){return S(e)===c.zc.STAGED_ACCEPTED},E=function(e){return S(e)===c.zc.PICKUP_DELIVERY_DINE_IN},O=function(e){return Object(u.Pd)(null===e||void 0===e?void 0:e.service)===c.db.DELIVERY&&E(e)},f=function(e){return Object(u.Pd)(null===e||void 0===e?void 0:e.service)===c.db.DELIVERY&&(O(e)||R(e)||_(e)||D(e))},I=function(e){return f(e)&&(null===e||void 0===e?void 0:e.deliveryPartner)},b=function(e){return f(e)&&!D(e)&&!T(e)},R=function(e){return S(e)===c.zc.DELIVERY_DISTA_CREATE_ASSIGN},_=function(e){return S(e)===c.zc.DELIVERY_DISTA},D=function(e){return S(e)===c.zc.DELIVERY_DISTA_DELIVERED},T=function(e){return S(e)===c.zc.CANCELLED},A=function(e){return _(e)||T(e)||D(e)},S=function(e){switch(Object(u.Pd)(null===e||void 0===e?void 0:e.status)){case c.Ac.STAGED:case c.Ac.ACCEPTED:return v.b.shouldGoogleSpotIgnoreOloFailure?c.zc.PICKUP_DELIVERY_DINE_IN:c.zc.STAGED_ACCEPTED;case c.Ac.SENT_TO_POS_COMPLETED:if(Object(u.Pd)(null===e||void 0===e?void 0:e.service)===c.db.PICKUP||Object(u.Pd)(null===e||void 0===e?void 0:e.service)===c.db.DINE_IN||Object(u.Pd)(null===e||void 0===e?void 0:e.service)===c.db.DELIVERY)return c.zc.PICKUP_DELIVERY_DINE_IN;break;case c.Ac.CREATED:case c.Ac.ASSIGNED:return c.zc.DELIVERY_DISTA_CREATE_ASSIGN;case c.Ac.PICKED_UP:case c.Ac.OUT_FOR_DELIVERY:case c.Ac.ARRIVED:return c.zc.DELIVERY_DISTA;case c.Ac.DELIVERED:return c.zc.DELIVERY_DISTA_DELIVERED;case c.Ac.CANCELLED:case c.Ac.CANCEL:return Object(u.Pd)(null===e||void 0===e?void 0:e.service)===c.db.DELIVERY?c.zc.CANCELLED:c.zc.FAILED;case c.Ac.SENT_TO_POS_FAILED:case c.Ac.PAYMENT_FAILED:return c.zc.FAILED}},p=function(e,n,t){if(null!==e&&void 0!==e&&e.orderAcceptedLoading)return Promise.resolve(!1);switch(S(e)){case c.zc.STAGED_ACCEPTED:return n(!0),Promise.resolve(!1);case c.zc.PICKUP_DELIVERY_DINE_IN:return n(!1),Promise.resolve(!0);case c.zc.DELIVERY_DISTA_CREATE_ASSIGN:case c.zc.DELIVERY_DISTA:case c.zc.DELIVERY_DISTA_DELIVERED:case c.zc.CANCELLED:return n(!1),Promise.resolve(!1);case c.zc.FAILED:return localStorage.setItem(c.Bc.STATUS_TEXT,c.Bc.FAILED),Object(u.Id)(t),Promise.resolve(!1)}},C=function(e,n,t,o,r,i,l,a,s){if(a){var E=i.userStatus,O=v.b.shouldGoogleSpotIgnoreOloFailure||Object(u.Pd)(null===t||void 0===t?void 0:t.status)===c.Ac.SENT_TO_POS_COMPLETED;Object(u.j)(O,!l,null===o||void 0===o?void 0:o.id,E.localized,null===n||void 0===n?void 0:n.tenantId)&&Object(u.y)(e,d.f,null===n||void 0===n?void 0:n.tenantId,r,s)}},j=function(e,n,t){n&&(t=setTimeout((function(){n(e),t&&clearTimeout(t)}),l.c))},y=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=null,d={emailId:null===n||void 0===n?void 0:n.userEmail,phoneNo:null===n||void 0===n?void 0:n.userPhone,orderNo:null===n||void 0===n?void 0:n.posOrderId,tenantId:null===n||void 0===n?void 0:n.tenantId},u=t+1;e(Object(i.d)(d,(function(){return j(u,o,r)})))},g=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=null,d={orderId:null===n||void 0===n?void 0:n.orderId,tenantId:null===n||void 0===n?void 0:n.tenantId,customerId:null===n||void 0===n?void 0:n.customerId},u=t+1;e(Object(r.c)(d,(function(){return j(u,o,i)})))},P=function(e){return e(Object(r.d)())},m=function(e){return e(Object(i.e)())},N=function(e){return e(Object(a.g)())},h=function(e){return e(Object(i.a)({value:[]}))},L=function(){sessionStorage.removeItem(c.ac.ORDER_TRACKING)},Y=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null!==n&&void 0!==n&&n.isExternalTrackOrder?y(e,n,t,o):g(e,n,t,o)},k=function(e,n,t,o,r,i){n&&null!==n&&void 0!==n&&n.orderId?0===t||s(o)&&t<l.a?Y(e,n,t,r):s(o)&&t>=l.a&&(localStorage.setItem("paymentStatus",c.Bc.FAILED),Object(u.Id)(i)):Object(u.Dd)(i)},H=function(e,n,t,r,i){r&&O(e)?Object(u.Id)(i):null!==e&&void 0!==e&&e.status&&(null===e||void 0===e?void 0:e.status)!==(null===n||void 0===n?void 0:n.status)?t(Object(o.a)(Object(o.a)({},n),{},{status:null===e||void 0===e?void 0:e.status,orderAcceptedLoading:null===e||void 0===e?void 0:e.orderAcceptedLoading,deliveryPartner:null===e||void 0===e?void 0:e.deliveryPartner,deliveryDistaRetryCountFlag:(null===n||void 0===n?void 0:n.deliveryDistaRetryCountFlag)+1})):t(Object(o.a)(Object(o.a)({},n),{},{deliveryDistaRetryCountFlag:(null===n||void 0===n?void 0:n.deliveryDistaRetryCountFlag)+1}))},V=function(e,n,t){if(O(e)&&!n)var o=setTimeout((function(){o&&clearTimeout(o)}),l.d)},U=function(e,n,t,r){var i,d;return Object(o.a)(Object(o.a)({},G(e,n,!1,t)),{},{orderAcceptedLoading:(null===n||void 0===n?void 0:n.orderAcceptedLoading)||!1,deliveryPartner:null,deliveryDistaRetryCountFlag:0,operatingTime:null===r||void 0===r||null===(i=r.store)||void 0===i||null===(d=i.summary)||void 0===d?void 0:d.timings})},G=function(e,n){var t,o,r,i,d,u,l,c,v,a,s,E=arguments.length>2&&void 0!==arguments[2]&&arguments[2],O=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},I={orderId:(null===n||void 0===n?void 0:n.id)||(null===O||void 0===O?void 0:O.id),customerId:(null===n||void 0===n||null===(t=n.customer)||void 0===t?void 0:t.id)||(null===O||void 0===O||null===(o=O.customer)||void 0===o?void 0:o.id),tenantId:e,service:(null===n||void 0===n?void 0:n.service)||(null===O||void 0===O?void 0:O.service),status:(null===n||void 0===n?void 0:n.status)||(null===O||void 0===O?void 0:O.status),orderTime:(null===n||void 0===n?void 0:n.fulfillmentDateTime)||(null===O||void 0===O?void 0:O.fulfillmentDateTime),deliveryPartner:(null===n||void 0===n?void 0:n.deliveryPartner)||(null===O||void 0===O?void 0:O.deliveryPartner),posOrderId:(null===n||void 0===n?void 0:n.posOrderId)||(null===O||void 0===O?void 0:O.posOrderId),userEmail:(null===n||void 0===n||null===(r=n.customer)||void 0===r?void 0:r.email)||(null===O||void 0===O||null===(i=O.customer)||void 0===i?void 0:i.email),userPhone:(null===n||void 0===n||null===(d=n.customer)||void 0===d?void 0:d.phoneNumber)||(null===n||void 0===n||null===(u=n.customer)||void 0===u?void 0:u.phone)||(null===O||void 0===O||null===(l=O.customer)||void 0===l?void 0:l.phoneNumber),postOrderDetails:n,isExternalTrackOrder:E};f&&null!==f&&void 0!==f&&null!==(c=f.storesWithStatus)&&void 0!==c&&c.length&&(I.operatingTime=null===f||void 0===f||null===(v=f.storesWithStatus)||void 0===v||null===(a=v[0])||void 0===a||null===(s=a.summary)||void 0===s?void 0:s.timings);return I},K=function(e){return e&&null!==e&&void 0!==e&&e.pastOrderResponse&&null!==e&&void 0!==e&&e.pastOrderResponse.length&&null!==e&&void 0!==e&&e.pastOrderResponse[0].id?null===e||void 0===e?void 0:e.pastOrderResponse[0]:null},z=function(e){var n;return e&&null!==e&&void 0!==e&&e.orderAccepted&&Object.keys(null===e||void 0===e?void 0:e.orderAccepted).length&&null!==e&&void 0!==e&&null!==(n=e.orderAccepted)&&void 0!==n&&n.id?null===e||void 0===e?void 0:e.orderAccepted:null},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=z(e);return null===r&&(r=K(n),o&&null===r&&(r=t&&Object.keys(null===t||void 0===t?void 0:t.postOrderDetails).length?null===t||void 0===t?void 0:t.postOrderDetails:{})),r||{}},W=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(localStorage.getItem(c.ac.PAYMENT_STATUS)!==c.Bc.FAILED){var t,o,r,i;if(n&&(null===(t=window)||void 0===t||null===(o=t.location)||void 0===o?void 0:o.pathname)===(null===c.Wc||void 0===c.Wc?void 0:c.Wc.PAYMENT_SUCCESS)||(null===(r=window)||void 0===r||null===(i=r.location)||void 0===i?void 0:i.pathname)===(null===c.Wc||void 0===c.Wc?void 0:c.Wc.CHECKOUT))return!1;P(e),m(e)}N(e),h(e),L()}}}]);